{{ config(
    materialized='incremental'
) }}

SELECT
    CONTRIB_0000.INFO_ROW:REG::string   AS REG_0000,
    CONTRIB_0000.INFO_ROW:CNPJ::string  AS CNPJ_0000,
    CONTRIB_C010.INFO_ROW:REG::string   AS REG_C010,
    CONTRIB_C010.INFO_ROW:CNPJ::string  AS CNPJ_C010
FROM
    CONTRIB_C010
LEFT JOIN
    CONTRIB_C001 
    ON CONTRIB_C001.FILE_ID = CONTRIB_C010.FILE_ID
   AND CONTRIB_C001.ROW_NUMBER = CONTRIB_C010.FATHER_ROW
LEFT JOIN
    CONTRIB_0000 
    ON CONTRIB_0000.FILE_ID = CONTRIB_C001.FILE_ID
   AND CONTRIB_0000.ROW_NUMBER = CONTRIB_C001.FATHER_ROW